---
layout: post
title: Build Single Page Apps - Part 9 - Navigation, Transitions, Storage, and Messaging
date: 2012-08-30 02:06
author: John
comments: true
categories: [amplify, html5, javascript, jquery, pluralsight, sammy, SPA]
---
<p>I like demo apps that show how to deal with real scenarios like navigation, animation, client storage, and event messaging. A SPA generally has multiple views of related data and uses navigation so it only makes sense that my new <a href="http://pluralsight.com">Pluralsight</a> course “<a href="http://jpapa.me/spaps">Single Page Apps with HTML5, ASP.NET Web API, Knockout, and jQuery</a>” demonstrates navigation. And frankly, the rest of the topics like animations and storage were just too cool to leave out.</p> <p><a href="http://jpapa.me/spaps"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/media/Windows-Live-Writer/d4d49c57f31e_12ABB/image_9.png" width="520" height="108"></a></p> <p>You can catch up on the previous posts in this series here:</p> <h3>More on the Code Camper SPA</h3> <p>Part 1 - <a href="http://jpapa.me/spapost1">The Story Begins (What is the Code Camper SPA?)</a></p> <p>Part 2 - <a href="http://jpapa.me/spapost2">Client Technologies</a></p> <p>Part 3 - <a href="/spapost3">Server Technologies (the Data Layer)</a></p> <p>Part 4 - <a href="http://jpapa.me/spapost4">Serving JSON with ASP.NET Web API</a></p> <p>Part 5 - <a href="http://jpapa.me/spapost5">HTML 5 and ASP.NET Web Optimization</a></p> <p>Part 6 - <a href="http://jpapa.me/spapost6">JavaScript Modules</a></p> <p>Part 7 - <a href="http://jpapa.me/spapost7">MVVM and KnockoutJS</a></p> <p>Part 8 - <a href="http://jpapa.me/spapost8">Data Services on the Client</a></p> <p>Part 9 - <a href="http://jpapa.me/spapost9">Navigation, Transitions, Storage and Messaging</a></p> <p>Part 10 - <a href="http://jpapa.me/spapost10">Saving, Change Tracking, and Commanding</a> </p> <p>Part 11 - Responsive Design and Mobility</p> <h3>Navigation/Routing</h3> <p>I had a few goals for navigation and I covered them all using <a href="http://sammyjs.org">Sammy.js</a> and its hash based navigation/routing. See the image below for some of the features I implemented.</p> <p><a href="http://images.johnpapa.net/wp-content/uploads/media/Windows-Live-Writer/d4d49c57f31e_12ABB/image_2.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/media/Windows-Live-Writer/d4d49c57f31e_12ABB/image_thumb.png" width="520" height="396"></a></p> <p>If I had wanted to use HTML5 pushState (not yet supported consistently in all modern browsers) I likely would have chosen differently. But I wanted the demo to work in a very broad set of browsers, so I decided to stick with Sammy’s hash based navigation. I am a fan of modularity so I wrapped up Sammy in a module I named my router. So if I wanted to swap it out later, it’s trivial.</p> <h3>Transitions</h3> <p>When flipping between different views, I wanted animations. I didn’t need them of course, but I wanted them to provide a subtle UX. So I chose to create a fade in and translation for my views. I wrapped this functionality into, you guessed it, a module (named “presenter”). </p> <p>Sammy catches the route, it tells the viewmodel to activate itself, then it uses my presenter module to transition the View into place.</p> <p><a href="http://images.johnpapa.net/wp-content/uploads/media/Windows-Live-Writer/d4d49c57f31e_12ABB/image_4.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/media/Windows-Live-Writer/d4d49c57f31e_12ABB/image_thumb_1.png" width="520" height="311"></a></p> <h3>Storage and Messaging</h3> <p>I wanted my users to be able to shut down the SPA and when they come back in, the app brings them right back to where they left off. For this, I used the browser’s storage. <a href="http://amplifyjs.com">AmplifyJS</a> made this dead simple and it hooks right into my router. The cool thing about this library is that it works all the way back to IE 5 according to their docs. It figures out what the browser supports, chooses the most modern storage type, and uses it. </p> <p>I also had a need for a pub/sub message in the demo. For you XAML folks think EventAggregator in Prism or Messenger in MVVM Light. AmplifyJS helped out with that too.</p> <h3>Commanding</h3> <p>I could have used the click event for all of my buttons. But I wanted to build functionality in for handling:</p> <ol> <li>disabling the button while it is executing  <li>handling async commands  <li>disabling the button when it is inappropriate to use</li></ol> <p><a href="http://images.johnpapa.net/wp-content/uploads/media/Windows-Live-Writer/d4d49c57f31e_12ABB/image_6.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/media/Windows-Live-Writer/d4d49c57f31e_12ABB/image_thumb_2.png" width="520" height="68"></a></p> <p>Leaning on my XAML experiences I worked with my friend Hans to build a asyncCommand object and we packaged it up, made it part of a library called KoLite, and posted it to <a href="http://jpapa.me/kolitegh">GitHub</a> and <a href="https://nuget.org/packages/KoLite">NuGet</a>. You can learn more about KoLite and its commanding features on <a href="http://jpapa.me/kolitegh">GitHub</a>. I’ll be blogging more about this library in the coming weeks too.</p> <h3>What Else</h3> <p>What else is in the course? Actually there is quite a bit more. Next up I’ll talk about saving data, change tracking, and more!</p>

