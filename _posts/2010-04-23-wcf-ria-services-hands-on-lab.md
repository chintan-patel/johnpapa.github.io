---
layout: post
title: WCF RIA Services - Hands On Lab
date: 2010-04-23 05:49
author: John
comments: true
categories: [Silverlight]
---
<p><font size="3" face="Segoe UI">At the </font><a href="http://www.microsoft.com/silverlight/silverlight-4-launch/"><font size="3" face="Segoe UI">keynote for the Silverlight 4 Launch alongside Scott Guthrie I demonstrated</font></a><font size="3" face="Segoe UI"> </font><a href="http://www.microsoft.com/silverlight/silverlight-4-launch/"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; margin: 5px 0px 5px 5px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" align="right" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_85.png" width="244" height="139" /></font></a><font size="3" face="Segoe UI">(minute 28 to minute 38) how to build a Silverlight 4 application using WCF RIA Services and the new Visual Studio 2010 tooling. </font></p>  <p><font size="3" face="Segoe UI">The application I built is an online book store to rival the big boys … OK, well, maybe not the big boys but you get the idea. As promised I am elaborating on the presentation and breaking down the steps to create the application here. </font></p>  <p><font size="3" face="Segoe UI">I included the starter solution and the completed solution for this presentation so you can try this out for yourself or simply run the completed solution if that interests you more. In this post I will go through the steps to create the application so you can try this as well.</font></p>  <p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_87.png"><font size="3" face="Segoe UI"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image193_2.png" width="352" height="69" /></font></a><font size="3" face="Segoe UI">&#160;</font></p>  <p><font size="3" face="Segoe UI">Here is the completed application that I will show how to build. You can select a book category and the books for that category will appear in the book list in the middle. You can sort by title or author or you can filter the book list by title or author. If you log into the application (as RIA Services integrates well with ASP.NET authentication) I show how to set up permissions to edit the book information too. OK, so this was a stretch as you really don’t want to allow book information to be edited by buyers, but work with me on this :-)</font></p>  <p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_80.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_39.png" width="555" height="349" /></font></a></p>  <h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_6.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image10.png" width="52" height="55" /></font></a><strong><font size="3" face="Segoe UI">Where Do We Start?</font></strong></h3>  <p><font size="3" face="Segoe UI">Let’s start by examining what is already in the project. Open the starter project and notice that there are already a Silverlight project and a Web project created. </font><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_4.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; margin: 0px 10px 0px 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" align="left" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_1.png" width="178" height="189" /></font></a><font size="3" face="Segoe UI">The application starts out with a SQL Server database containing information about the books. This image shows the Entity Framework model that maps to the SQL Server database. We will be talking to the EF model which in turn talks to SQL Server. Of course this model can be a 1-1 model to table mapping or it could be much more complex. Also, this could have been an nHibernate model or a custom model … RIA Services will sit on top of a variety of models.</font></p>  <p><font size="3" face="Segoe UI">So the lower tier architecture contains a SQL Server database which stores the book information and an Entity Framework model which maps to that SQL Server database. RIA Services will operate on the Entity Framework model for both retrieving and modifying data using LINQ to Entities in this application.</font></p>  <h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_10.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image19.png" width="56" height="60" /></font></a><strong><font size="3" face="Segoe UI">Create the Domain Service</font></strong></h3>  <p><font size="3" face="Segoe UI">To create the domain service you then add a new Domain Service Class to the Web project and name it BookClubService.cs.</font></p>  <p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_12.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_5.png" width="244" height="139" /></font></a><font size="3" face="Segoe UI">&#160;</font></p>  <h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_14.png"><strong><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image27.png" width="54" height="57" /></font></strong></a><strong><font size="3" face="Segoe UI">Configure the Domain Service</font></strong></h3>  <p><font size="3" face="Segoe UI">When you configure the domain service RIA Services can see all of the entities that the Entity Framework model exposes. You can select which entities you want the domain service to </font><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_16.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; margin: 0px 10px 0px 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" align="left" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_7.png" width="200" height="244" /></font></a><font size="3" face="Segoe UI">expose and if they should be editable through this dialog. I’m going to select the Book, BookOfDay and Category and enable editing of the Book. This tells RIA Services to generate methods in the domain service class to return the entities and to create methods to save changes to the Book entity.</font></p>  <p><font size="3" face="Segoe UI">I will also check the box to “Generate associated classes for metadata”. This creates a BookClubService.metadata.cs class. This is where you can define validation and business rules that you want to share between the server and the client. The code in this class will be copied to the Silverlight client when the application is compiled.</font></p>  <p><font size="3" face="Segoe UI">&#160;</f
ont></p>  <h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_18.png"><strong><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image35.png" width="53" height="57" /></font></strong></a><strong><font size="3" face="Segoe UI">Returning Object Graphs</font></strong></h3>  <p><font size="3" face="Segoe UI">When we get the book of the day we want to get the BookOfDay entity and its child entity, Book. By default when asking for a BookOfDay entity from a domain service it will only return BookOfDay entities, and no child entities. Since this is not what we want we can decorate the Book property of the BookOfDayMetadata class with the Include attribute. We’ll also have to configure the domain service method for getting the BookOfDay entities to include the Book entities too … but we’ll do that in the next step.</font></p>  <div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">   <div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">     <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">internal</span> <span style="color: #0000ff">sealed</span> <span style="color: #0000ff">class</span> BookOfDayMetadata</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum2">   2:</span> {</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #008000">// Metadata classes are not meant to be instantiated.</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum4">   4:</span>     <span style="color: #0000ff">private</span> BookOfDayMetadata()</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum5">   5:</span>     {</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum6">   6:</span>     }</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum7">   7:</span>     <span style="color: #008000">//Include the book for the object graph</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum8">   8:</span>     [Include]</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum9">   9:</span>     <span style="color: #0000ff">public</span> Book Book { get; set; }</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum10">  10:</span>     <span style="color: #0000ff">public</span> <span style="color: #0000ff">int</span> BookID { get; set; }</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum11">  11:</span>     <span style="color: #0000ff">public</span> DateTime Day { get; set; }</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum12">  12:</span> }</font></font></pre>
<!--CRLF--></div>
</div>
<h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_20.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image39.png" width="55" height="58" /></font></a><strong><font size="3" face="Segoe UI">Customize the Domain Service Methods</font></strong></h3>
<p><font size="3" face="Segoe UI">The BookClubService class (generated in step 3) contains a series of methods that will be exposed to the Silverlight client. You should see a series of methods to retrieves the entities and a few methods to insert, update and delete Book entities. While this code is generated we can modify the code without risk of it being overwritten. (The domain service generated class is not one that is regenerated on the fly.) So we can edit the GetBooks method to return the books in sequence by title.</font></p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">public</span> IQueryable&lt;Book&gt; GetBooks()</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum2">   2:</span> {</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">return</span> <span style="color: #0000ff">this</span>.ObjectContext.Books.OrderBy(b =&gt; b.Title);</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum4">   4:</span> }</font></font></pre>
<!--CRLF--></div>
</div>
<p><font size="3" face="Segoe UI">Then change the GetCategories method to order the Category entities by the CategoryName.</font></p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">public</span> IQueryable&lt;Category&gt; GetCategories()</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum2">   2:</span> {</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">return</span> <span style="color: #0000ff">this</span>.ObjectContext.Categories.OrderBy(c =&gt; c.CategoryName);</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum4">   4:</span> }</font></font></pre>
<!--CRLF--></div>
</div>
<p><font size="3" face="Segoe UI">Now change the GetBookOfDays method to include the Book entity and return the most recent BookOfDay entity and its Book.</font></p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">public</span> IQueryable&lt;BookOfDay&gt; GetBookOfDays()</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum2">   2:</span> {</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">return</span> <span style="color: #0000ff">this</span>.ObjectContext.BookOfDays.Include(<span style="color: #006080">&quot;Book&quot;</span>).OrderByDescending</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum4">   4:</span>         (b =&gt; b.Day).Take(1);</font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum5">   5:</span> }</font></font></pre>
<!--CRLF--></div>
</div>
<p><font size="3" face="Segoe UI">Build the application and the services will be exposed, the models shared, and the metadata shared to the Silverlight client.</font></p>
<h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_22.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image43.png" width="54" height="53" /></font></a><strong><font size="3" face="Segoe UI">Configure the Data Sources to use ListBox Controls</font></strong></h3>
<p><font size="3" face="Segoe UI">Now let’s go to the Silverlight client in Visual Studio 2010. Open the Home.xaml View in the designer. Styles have already been applied to the View by my Designer, which yields a nice l</font><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_26.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; margin: 0px 10px 0px 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" align="left" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_12.png" width="205" height="144" /></font></a><font size="3" face="Segoe UI">ooking control. But we have to hook the functionality (data, buttons, actions, behaviors) up. Let’s start by opening the Data Sources window and verifying that we see the Book, BookOfDay and Category show up under the BookClubContext. These can be dragged to the design surface which then creates a Domain Data Source (DDS) and a DataGrid in the View’s XAML. The DDS calls the GetBooks method in the domain service in the web project and binds the results to the DataGrid. </font><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_28.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; margin: 0px 0px 0px 10px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" align="right" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_13.png" width="174" height="145" /></font></a></p>
<p><font size="3" face="Segoe UI">We don’t want a DataGrid, though. So lets change the type of control to a ListBox. Click the arrow to the right of the Book in the Data Source window and select Customize. When the Customize Control Binding dialog appears scroll to ListBox, select it, and click the Set Default button. This tells the Data Sources window that we want the ListBox to be the default option when dragging and dropping to the design surface.</font></p>
<p><font size="3" face="Segoe UI">Now, go back to the Data Sources window and the Book should now show a different icon that represents the ListBox.</font></p>
<p><font size="3" face="Segoe UI">&#160;</font><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_32.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; margin: 0px 5px 0px 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_15.png" width="199" height="137" /></font></a></p>
<h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_34.png"><font size="3" face="Segoe UI"><strong><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image79.png" width="54" height="57" /></strong></font></a><strong><font size="3" face="Segoe UI">Drag the Data Sources to the Design Surface </font></strong></h3>
<h3><font size="3" face="Segoe UI">Drag the Category from the Data Source window to the rectangular Grid panel below the Book Categories title. Then right click the ListBox and choose Reset Layout | All. This makes the ListBox consume all of the space inside of the Grid.</font></h3>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_36.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; margin: 0px 10px 0px 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" align="left" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_17.png" width="235" height="244" /></font></a></p>
<p><font size="3" face="Segoe UI">Drag the BookOfDay to the BookOfDay Grid and reset the layout to “all”. Then drag the Book to the Book Grid and reset the layout to “all”.</font></p>
<p><font size="3" face="Segoe UI">The ListBox controls are now created, aligned, and bound to the newly created DDS controls. The Silverlight client is also now wired up to retrieve the data for these bindings from the domain service class we created in the previous steps.</font></p>
<p><font size="3" face="Segoe UI">Now drag the Book from the Data Sources window onto the DataPager control. This binds the DataPager to the same DDS that the Book ListBox is bound to, thus enabling paging.</font></p>
<h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_40.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image91.png" width="53" height="54" /></font></a><font size="3" face="Segoe UI"><strong><font size="3" face="Segoe UI">Apply the DataTemplates</font></strong></font></h3>
<p><font size="3" face="Segoe UI">Now it is time to apply the DataTemplates for the 3 ListBox controls. These DataTemplates were created in advance by our designer as resources and are quite simple. For example, the DataTemplate for Book looks like this:</font></p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">DataTemplate</span> <span style="color: #ff0000">x:Key</span><span style="color: #0000ff">=&quot;BookItemTemplate&quot;</span><span style="color: #0000ff">&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum2">   2:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">StackPanel</span> <span style="color: #ff0000">Orientation</span><span style="color: #0000ff">=&quot;Horizontal&quot;</span><span style="color: #0000ff">&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum3">   3:</span>         <span style="color: #0000ff">&lt;</span><span style="color: #800000">TextBlock</span> <span style="color: #ff0000">Text</span><span style="color: #0000ff">=&quot;{Binding Title}&quot;</span> <span style="color: #ff0000">Margin</span><span style="color: #0000ff">=&quot;8,0&quot;</span><span style="color: #0000ff">/&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum4">   4:</span>         <span style="color: #0000ff">&lt;</span><span style="color: #800000">TextBlock</span> <span style="color: #ff0000">Text</span><span style="color: #0000ff">=&quot;(by &quot;</span><span style="color: #0000ff">/&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum5">   5:</span>         <span style="color: #0000ff">&lt;</span><span style="color: #800000">TextBlock</span> <span style="color: #ff0000">Text</span><span style="color: #0000ff">=&quot;{Binding Author}&quot;</span><span style="color: #0000ff">/&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum6">   6:</span>         <span style="color: #0000ff">&lt;</span><span style="color: #800000">TextBlock</span> <span style="color: #ff0000">Text</span><span style="color: #0000ff">=&quot;)&quot;</span><span style="color: #0000ff">/&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum7">   7:</span>     <span style="color: #0000ff">&lt;/</span><span style="color: #800000">StackPanel</span><span style="color: #0000ff">&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum8">   8:</span> <span style="color: #0000ff">&lt;/</span><span style="color: #800000">DataTemplate</span><span style="color: #0000ff">&gt;</span></font></font></pre>
<!--CRLF--></div>
</div>
<p><font size="3" face="Segoe UI">We can apply the DataTemplates to the ListBoxes using the new Visual Studio 2010 tooling for </font><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_38.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; margin: 0px 10px 0px 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" align="left" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_18.png" width="340" height="131" /></font></a><font size="3" face="Segoe UI">applying resources. Select the Category ListBox in the designer, go to the Properties window, and find the ItemTemplate property. Click the gray arrow in the right hand side of the ItemTemplate’s value box and the following dialog should appear. This shows all of the matching options, which in this case are the DataTemplates within scope that can be applied to this ListBox’s ItemTemplate property. Select the CategoryItemTemplate. Now repeat the process and apply the BookOfDayItemTemplate and the BookItemTemplate to their respective ListBox controls. Our ListBox controls are now laid out, styled, bound and templated.</font></p>
<h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_45.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image1.png" width="53" height="55" /></font></a><font size="3" face="Segoe UI"><strong><font size="3" face="Segoe UI">Apply Filters</font></strong></font></h3>
<p><font size="3" face="Segoe UI">We want to filer the books by the selected category and by the title or author (whichever is selected in the combobox and value typed into the TextBox above the Book’s ListBox). We can do this through the Visual Studio 2010 tooling by first going to the Document Outline window and selecting the bookDomainDataSource. Open the Properties window, find the FilterDescriptors property, and click the button (the one with the 3 dots).</font></p>
<p><font size="3" face="Segoe UI">When the Collection Editor for the FilterDescriptors appears click the Add button to add a new filter. This filter will make sure the books are filtered by the selected category. Set the PropertyPath to the string “CategoryID” (without quotes). Then click the square next to the Value property, click the Apply Data Binding options, and the binding dialog appears. For the Source select the ElementName binding and the categorylistBox, as shown below.</font></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_54.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_26.png" width="576" height="378" /></font></a></p>
<p><font size="3" face="Segoe UI">Now for the Path select the SelectedItem property as shown below. We just created a filter so only books for the selected category will appear.</font></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_56.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_27.png" width="569" height="322" /></font></a></p>
<p><font size="3" face="Segoe UI">Now we need to create a filter by the partial name entered for the author or title. Add another filter descriptor and set the Operator to Contains (we want to do partial matching of the title or author). Bind the PropertyPath to the cboSort combobox’s SelectedItem.Content property, as shown below.</font></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_58.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_28.png" width="563" height="319" /></font></a></p>
<p><font size="3" face="Segoe UI">Then bind the TextBox named txtFilter and to its Text property, as shown below.</font></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_60.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_29.png" width="564" height="317" /></font></a></p>
<p><font size="3" face="Segoe UI">These steps created the filters but there are 2 additional steps we need to take. First, we need to go to the XAML of the filter for the category and set the Path to SelectedItem.CategoryID. (The tooling does not support the free form entry of the CategoryID in the filter dialog.) Next, I want the FallBackValue for the same filter to be set to 1. This way if a category is not selected the filter will be applied to the first category. When you are done, your XAML for the filters&#160; should look like this:</font></p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">riaControls:DomainDataSource.FilterDescriptors</span><span style="color: #0000ff">&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum2">   2:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">riaControls:FilterDescriptor</span> <span style="color: #ff0000">Operator</span><span style="color: #0000ff">=&quot;IsEqualTo&quot;</span> <span style="color: #ff0000">PropertyPath</span><span style="color: #0000ff">=&quot;CategoryID&quot;</span> <span style="color: #ff0000">Value</span><span style="color: #0000ff">=&quot;{Binding ElementName=categoryListBox, Path=SelectedItem.CategoryID, FallbackValue=1}&quot;</span> <span style="color: #0000ff">/&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">riaControls:FilterDescriptor</span> <span style="color: #ff0000">Operator</span><span style="color: #0000ff">=&quot;Contains&quot;</span> <span style="color: #ff0000">PropertyPath</span><span style="color: #0000ff">=&quot;{Binding Path=SelectedItem.Content, ElementName=cboSort}&quot;</span> <span style="color: #ff0000">Value</span><span style="color: #0000ff">=&quot;{Binding ElementName=txtFilter, Path=Text}&quot;</span> <span style="color: #0000ff">/&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum4">   4:</span> <span style="color: #0000ff">&lt;/</span><span style="color: #800000">riaControls:DomainDataSource.FilterDescriptors</span><span style="color: #0000ff">&gt;</span></font></font></pre>
<!--CRLF--></div>
</div>
<h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_50.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image114.png" width="52" height="53" /></font></a><font size="3" face="Segoe UI"><strong><font size="3" face="Segoe UI">Apply Sorting</font></strong></font></h3>
<p><font size="3" face="Segoe UI">The next step is to apply the sorting. Select the bookDomainDataSource from the Document Outline window, go to the Properties window, and find the Sort Descriptors property. Click the button and when the sort dialog opens, add a new SortDescriptor. Here we want to sort by the selected value in the cboSort combobox. Click the PropertyPath’s binding icon and select the Apply Data Binding option. Set the Source to cboSort and set the Path to SelectedItem.Content.</font></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_62.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_30.png" width="547" height="330" /></font></a></p>
<p><font size="3" face="Segoe UI">Your XAML for the SortDescriptor should look like this:</font></p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">riaControls:DomainDataSource.SortDescriptors</span><span style="color: #0000ff">&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum2">   2:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">riaControls:SortDescriptor</span> <span style="color: #ff0000">PropertyPath</span><span style="color: #0000ff">=&quot;{Binding Path=SelectedItem.Content, ElementName=cboSort}&quot;</span> <span style="color: #0000ff">/&gt;</span></font></font></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><font size="3"><font face="Segoe UI"><span style="color: #606060" id="lnum3">   3:</span> <span style="color: #0000ff">&lt;/</span><span style="color: #800000">riaControls:DomainDataSource.SortDescriptors</span><span style="color: #0000ff">&gt;</span></font></font></pre>
<!--CRLF--></div>
</div>
<h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_64.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image145.png" width="54" height="56" /></font></a><font size="3" face="Segoe UI"><font size="3" face="Segoe UI"><strong><font size="3" face="Segoe UI">Bind the Book Control</font></strong></font></font></h3>
<p><font size="3" face="Segoe UI">The next step is to bind the selected book (from the ListBox) to the BookControl. The BookControl is already created (in a separate XAML file in my project). It contains the layout to display and edit the book’s property values. All it needs is a book for its DataContext to bind to.</font></p>
<p><font size="3" face="Segoe UI">Select the BookControl, go to the Properties window, and find the DataContext property. Click the binding button next to the DataContext property and choose the Apply Data Binding option. use the binding picker to bind to the ElementName of bookListBox and the Path of SelectedItem. Now our BookControl is bound to the selected book.</font></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_66.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_32.png" width="555" height="466" /></font></a></p>
<h3><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_68.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image154.png" width="53" height="54" /></font></a><font size="3" face="Segoe UI"><font size="3" face="Segoe UI"><font size="3" face="Segoe UI"><strong><font size="3" face="Segoe UI">Bind the Submit Button</font></strong></font></font></font></h3>
<p><font size="3" face="Segoe UI">We can support saving changes made by the user by binding the Submit button control to the bookDomainDataSource control’s SubmitChanges method. Select the btnSubmit control, go to the properties window, and find the Command property. Click the binding button next to the property and choose the Apply Data Binding option. Set the Source to the bookDomainDataSource and set the Path to the SubmitChangesCommand. (This command is part of the DDS you created when you dragged the Book from the Data Sources window onto the design surface.)</font></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_70.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_34.png" width="557" height="350" /></font></a></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_72.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image162.png" width="328" height="71" /></font></a></p>
<p><font size="3" face="Segoe UI">Now it is time to run the application. Click the login link and register a username and a password.You will need this information to log into the application so you can edit the book details.</font></p>
<blockquote>
<p><em><font size="3" face="Segoe UI">This will take advantage of the authentication that is set up by default by WCF RIA Services. This includes an auth database, services to log in and register users, log in controls, and wiring up the services to the Silverlight client. </font></em></p>
</blockquote>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_74.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_36.png" width="409" height="191" /></font></a></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_76.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_37.png" width="411" height="355" /></font></a></p>
<p><font size="3" face="Segoe UI">Once you log in you can use the application to:</font></p>
<ul>
<li><font size="3" face="Segoe UI">choose different categories and watch the books get filtered </font></li>
<li><font size="3" face="Segoe UI">change the sorting for the books </font></li>
<li><font size="3" face="Segoe UI">filter the books by partial name of the author or title </font></li>
<li><font size="3" face="Segoe UI">select a book and view the book details in the book control </font></li>
<li><font size="3" face="Segoe UI">page through the books </font></li>
<li><font size="3" face="Segoe UI">edit details of a book </font></li>
<li><font size="3" face="Segoe UI">submit the changes for the book </font></li>
</ul>
<p><font size="3" face="Segoe UI">You might notice when you edit the book details that some fields are in bold. These fields have validation attributes applied to them for required fields. If you remove the text from the ASIN TextBox the control will be highlighted in red. This means the validation condition not been met. If you hover over the upper right corner of the TextBox on the red triangle you will see a message that explains the problem.</font></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_78.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_thumb_38.png" width="421" height="239" /></font></a><font size="3" face="Segoe UI">&#160;</font></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_82.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; margin: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image183.png" width="369" height="68" /></font></a></p>
<p><font size="3" face="Segoe UI">This application stepped you through creating the fictitious Online Book Shelf application using RIA Services. if you have 10 minutes, you can watch me follow these steps (rather quickly with some variations) from the keynote from the Silverlight 4 launch using the following link. I begin 28 minutes in and spend about 9 1/2 minutes on the demo.</font></p>
<ul>
<li><a href="http://www.microsoft.com/silverlight/silverlight-4-launch/"><font size="3" face="Segoe UI">Video for the Silverlight 4 launch Keynote</font></a><font size="3" face="Segoe UI"> </font></li>
</ul>
<p><font size="3" face="Segoe UI">You can download the source for the completed version of the application or the starter from these links:</font></p>
<ul>
<li><a href="http://images.johnpapa.net/wp-content/uploads/files/downloads/BookShelfStarter.zip"><font size="3" face="Segoe UI">Source for the Starter Solution</font></a><font size="3" face="Segoe UI"> </font></li>
<li><a href="http://images.johnpapa.net/wp-content/uploads/files/downloads/BookShelfSolution.zip"><font size="3" face="Segoe UI">Source for the Completed Solution</font></a><font size="3" face="Segoe UI"> </font></li>
</ul>
<p><em><font size="3" face="Segoe UI">NOTE: After you download the zip files, make sure you unblock them. Also, I recommend cleaning the solution before you start working through the steps.</font></em></p>
<p><em><font size="3" face="Segoe UI"></font></em></p>
<p><a href="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image_43.png"><font size="3" face="Segoe UI"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.johnpapa.net/wp-content/uploads/files/media/image/WindowsLiveWriter/WCFRIAServices_F1B2/image1%5B1%5D.png" width="129" height="57" /></font></a><font size="3" face="Segoe UI"> </font></p>
<p><font size="3" face="Segoe UI">Several people contributed heavily to this keynote demo and application including </font><a href="http://twitter.com/deepeshm"><font size="3" face="Segoe UI">Deepesh Mohnani,</font></a><font size="3" face="Segoe UI"> </font><a href="http://twitter.com/JeffHandley"><font size="3" face="Segoe UI">Jeff Handley</font></a><font size="3" face="Segoe UI">, Dinesh Kulkarni, and </font><a href="http://twitter.com/nikhilk"><font size="3" face="Segoe UI">Nikhil Kothari</font></a><font size="3" face="Segoe UI">. Thank you all for your huge contributions! </font></p>
<p><strong><font size="3" face="Segoe UI">Now for something Different …</font></strong></p>
<p><font size="3" face="Segoe UI">If you made it this far in the post, you can even watch a pre-keynote warmup (tongue in cheek) from me and Ward Bell. </font></p>
<p><font size="3" face="Segoe UI">&#160; </font></p>
<div style="padding-bottom: 5px; margin: 0px; padding-left: 0px; padding-right: 5px; display: inline; float: none; padding-top: 5px" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:8e98736b-7bfa-494c-9597-4d775e45bfdc" class="wlWriterEditableSmartContent"><div><object width="425" height="355"><param name="movie" value="http://www.youtube.com/v/MRLel2DmADw&amp;hl=en"></param><embed src="http://www.youtube.com/v/MRLel2DmADw&amp;hl=en" type="application/x-shockwave-flash" width="425" height="355"></embed></object></div></div>
<p><font size="3" face="Segoe UI"></font></p>

